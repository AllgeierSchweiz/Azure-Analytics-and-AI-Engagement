{
    "name": "DfWWIProductDataToLakeDB",
    "properties": {
        "folder": {
            "name": "Load WWI And Magento Data To LakeDB"
        },
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "WWIData",
                        "type": "DatasetReference"
                    },
                    "name": "WWIProduct"
                },
                {
                    "dataset": {
                        "referenceName": "ProductBrand",
                        "type": "DatasetReference"
                    },
                    "name": "WWIBrand"
                }
            ],
            "sinks": [
                {
                    "name": "Product"
                },
                {
                    "name": "Brand"
                }
            ],
            "transformations": [
                {
                    "name": "GetEntityCodeForProducts"
                },
                {
                    "name": "SelectProductAttributes"
                },
                {
                    "name": "GetBrandAttributes"
                }
            ],
            "script": "source(output(\n\t\tProducts_ID as string,\n\t\tProductID as string,\n\t\tName as string,\n\t\tBrand as string,\n\t\tPrice as string,\n\t\tCategory as string,\n\t\tThumbnail_FileName as string,\n\t\tAdImage_FileName as string,\n\t\tSoundFile_FileName as string,\n\t\tSubCampaigns as string,\n\t\tTargetGender as string,\n\t\tTargetClassification as string,\n\t\tTargetGeneration as string,\n\t\tTags as string,\n\t\tBLECode as string,\n\t\tThumbnail as string,\n\t\tAdImage as string,\n\t\tSoundFile as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> WWIProduct\nsource(output(\n\t\tBrandID as string,\n\t\tBrandName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> WWIBrand\nWWIProduct derive(EntityCode = concat('WideWorldImporters'),\n\t\tItemSku = 'Null',\n\t\tDes = concat(Name,' ',' Description'),\n\t\tShortDes = 'Null') ~> GetEntityCodeForProducts\nGetEntityCodeForProducts select(mapColumn(\n\t\tProductsId = Products_ID,\n\t\tProductName = Name,\n\t\tProductCategories = Category,\n\t\tEntityCode,\n\t\tItemSku,\n\t\tBrandName = Brand,\n\t\tProductDescription = Des,\n\t\tProductShortDescription = ShortDes\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelectProductAttributes\nWWIBrand derive(des = 'Null',\n\t\tEntityCode = 'WideWorldImporters') ~> GetBrandAttributes\nSelectProductAttributes sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'Product',\n\tmapColumn(\n\t\tProductId = ProductsId,\n\t\tProductName,\n\t\tProductCategories,\n\t\tEntityCode,\n\t\tItemSku,\n\t\tBrandName,\n\t\tProductDescription,\n\t\tProductShortDescription\n\t)) ~> Product\nGetBrandAttributes sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'Brand',\n\tmapColumn(\n\t\tBrandId = BrandID,\n\t\tBrandName,\n\t\tBrandDescription = des,\n\t\tEntityCode\n\t)) ~> Brand"
        }
    }
}