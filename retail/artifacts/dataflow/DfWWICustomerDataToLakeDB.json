{
    "name": "DfWWICustomerDataToLakeDB",
    "properties": {
        "folder": {
            "name": "Load WWI And Magento Data To LakeDB"
        },
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "WWICustomer",
                        "type": "DatasetReference"
                    },
                    "name": "WWICustomerData"
                }
            ],
            "sinks": [
                {
                    "name": "Customer"
                },
                {
                    "name": "CustomerGender"
                },
                {
                    "name": "CustomerEmail"
                }
            ],
            "transformations": [
                {
                    "name": "GetEntityCodeForCustomer"
                },
                {
                    "name": "GetCustomerAttributes"
                },
                {
                    "name": "GetCustomerGenderAttributes"
                },
                {
                    "name": "GetCustomerEmailAttributes"
                }
            ],
            "script": "source(output(\n\t\tId as string,\n\t\tAge as string,\n\t\tGender as string,\n\t\tPincode as string,\n\t\tFirstName as string,\n\t\tLastName as string,\n\t\tFullName as string,\n\t\tDateOfBirth as string,\n\t\tAddress as string,\n\t\tEmail as string,\n\t\tMobile as string,\n\t\tUserName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> WWICustomerData\nWWICustomerData derive(EntityCode = 'WideWorldImporters',\n\t\tOrderId = 'Null',\n\t\tCustomerMiddleName = 'Null',\n\t\tCustomerGenderNote = concat(Gender,' ' ,'Customer'),\n\t\tCustomerEmailID = 'Null') ~> GetEntityCodeForCustomer\nGetEntityCodeForCustomer select(mapColumn(\n\t\tCustomerId = Id,\n\t\tCustomerFirstName = FirstName,\n\t\tCustomerLastName = LastName,\n\t\tCustomerFullName = FullName,\n\t\tCustomerDOB = DateOfBirth,\n\t\tEntityCode,\n\t\tOrderId,\n\t\tCustomerMiddleName\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> GetCustomerAttributes\nGetEntityCodeForCustomer select(mapColumn(\n\t\tCustomerId = Id,\n\t\tCustomerGender = Gender,\n\t\tEntityCode,\n\t\tCustomerGenderNote\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> GetCustomerGenderAttributes\nGetEntityCodeForCustomer select(mapColumn(\n\t\tCustomerId = Id,\n\t\tEmailAddress = Email,\n\t\tEntityCode,\n\t\tEmailTypeId = CustomerEmailID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> GetCustomerEmailAttributes\nGetCustomerAttributes sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'Customer',\n\tmapColumn(\n\t\tCustomerId,\n\t\tCustomerFirstName,\n\t\tCustomerMiddleName,\n\t\tCustomerLastName,\n\t\tCustomerFullName,\n\t\tCustomerDOB,\n\t\tEntityCode,\n\t\tOrderId\n\t)) ~> Customer\nGetCustomerGenderAttributes sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'CustomerGender',\n\tmapColumn(\n\t\tCustomerId,\n\t\tCustomerGender,\n\t\tEntityCode,\n\t\tCustomerGenderNote\n\t)) ~> CustomerGender\nGetCustomerEmailAttributes sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'CustomerEmail') ~> CustomerEmail"
        }
    }
}