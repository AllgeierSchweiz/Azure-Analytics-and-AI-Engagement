{
    "name": "DfPaymentRecordsToLakeDB",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "DatasetMagento",
                        "type": "DatasetReference"
                    },
                    "name": "SourceMagentoOrders"
                }
            ],
            "sinks": [
                {
                    "name": "PaymentStatus"
                },
                {
                    "name": "Payment"
                }
            ],
            "transformations": [
                {
                    "name": "Filter1"
                },
                {
                    "name": "GetPaymentStatusAttributes"
                },
                {
                    "name": "Select3"
                },
                {
                    "name": "GetPaymentDescription"
                },
                {
                    "name": "GetDistinctPaymentStatus"
                },
                {
                    "name": "GetEntityCodeForPayment"
                }
            ],
            "script": "source(output(\n\t\tentity_id as string,\n\t\tincrement_id as string,\n\t\tstate as string,\n\t\tstatus as string,\n\t\tcoupon_code as string,\n\t\tprotect_code as string,\n\t\tshipping_description as string,\n\t\tis_virtual as string,\n\t\tstore_id as string,\n\t\tcustomer_id as string,\n\t\tbase_discount_amount as string,\n\t\tbase_discount_canceled as string,\n\t\tbase_discount_invoiced as string,\n\t\tbase_discount_refunded as string,\n\t\tbase_grand_total as string,\n\t\tbase_shipping_amount as string,\n\t\tbase_shipping_canceled as string,\n\t\tbase_shipping_invoiced as string,\n\t\tbase_shipping_refunded as string,\n\t\tbase_shipping_tax_amount as string,\n\t\tbase_shipping_tax_refunded as string,\n\t\tbase_subtotal as string,\n\t\tbase_subtotal_canceled as string,\n\t\tbase_subtotal_invoiced as string,\n\t\tbase_subtotal_refunded as string,\n\t\tbase_tax_amount as string,\n\t\tbase_tax_canceled as string,\n\t\tbase_tax_invoiced as string,\n\t\tbase_tax_refunded as string,\n\t\tbase_to_global_rate as string,\n\t\tbase_to_order_rate as string,\n\t\tbase_total_canceled as string,\n\t\tbase_total_invoiced as string,\n\t\tbase_total_invoiced_cost as string,\n\t\tbase_total_offline_refunded as string,\n\t\tbase_total_online_refunded as string,\n\t\tbase_total_paid as string,\n\t\tbase_total_qty_ordered as string,\n\t\tbase_total_refunded as string,\n\t\tdiscount_amount as string,\n\t\tdiscount_canceled as string,\n\t\tdiscount_invoiced as string,\n\t\tdiscount_refunded as string,\n\t\tgrand_total as string,\n\t\tshipping_amount as string,\n\t\tshipping_canceled as string,\n\t\tshipping_invoiced as string,\n\t\tshipping_refunded as string,\n\t\tshipping_tax_amount as string,\n\t\tshipping_tax_refunded as string,\n\t\tstore_to_base_rate as string,\n\t\tstore_to_order_rate as string,\n\t\tsubtotal as string,\n\t\tsubtotal_canceled as string,\n\t\tsubtotal_invoiced as string,\n\t\tsubtotal_refunded as string,\n\t\ttax_amount as string,\n\t\ttax_canceled as string,\n\t\ttax_invoiced as string,\n\t\ttax_refunded as string,\n\t\ttotal_canceled as string,\n\t\ttotal_invoiced as string,\n\t\ttotal_offline_refunded as string,\n\t\ttotal_online_refunded as string,\n\t\ttotal_paid as string,\n\t\ttotal_qty_ordered as string,\n\t\ttotal_refunded as string,\n\t\tcan_ship_partially as string,\n\t\tcan_ship_partially_item as string,\n\t\tcustomer_is_guest as string,\n\t\tcustomer_note_notify as string,\n\t\tbilling_address_id as string,\n\t\tcustomer_group_id as string,\n\t\tedit_increment as string,\n\t\temail_sent as string,\n\t\tsend_email as string,\n\t\tforced_shipment_with_invoice as string,\n\t\tpayment_auth_expiration as string,\n\t\tquote_address_id as string,\n\t\tquote_id as string,\n\t\tshipping_address_id as string,\n\t\tadjustment_negative as string,\n\t\tadjustment_positive as string,\n\t\tbase_adjustment_negative as string,\n\t\tbase_adjustment_positive as string,\n\t\tbase_shipping_discount_amount as string,\n\t\tbase_subtotal_incl_tax as string,\n\t\tbase_total_due as string,\n\t\tpayment_authorization_amount as string,\n\t\tshipping_discount_amount as string,\n\t\tsubtotal_incl_tax as string,\n\t\ttotal_due as string,\n\t\tweight as string,\n\t\tcustomer_dob as string,\n\t\tapplied_rule_ids as string,\n\t\tbase_currency_code as string,\n\t\tcustomer_email as string,\n\t\tcustomer_firstname as string,\n\t\tcustomer_lastname as string,\n\t\tcustomer_middlename as string,\n\t\tcustomer_prefix as string,\n\t\tcustomer_suffix as string,\n\t\tcustomer_taxvat as string,\n\t\tdiscount_description as string,\n\t\text_customer_id as string,\n\t\text_order_id as string,\n\t\tglobal_currency_code as string,\n\t\thold_before_state as string,\n\t\thold_before_status as string,\n\t\torder_currency_code as string,\n\t\toriginal_increment_id as string,\n\t\trelation_child_id as string,\n\t\trelation_child_real_id as string,\n\t\trelation_parent_id as string,\n\t\trelation_parent_real_id as string,\n\t\tremote_ip as string,\n\t\tshipping_method as string,\n\t\tstore_currency_code as string,\n\t\tx_forwarded_for as string,\n\t\tcustomer_note as string,\n\t\tcreated_at as string,\n\t\tupdated_at as string,\n\t\ttotal_item_count as string,\n\t\tcustomer_gender as string,\n\t\tdiscount_tax_compensation_amount as string,\n\t\tbase_discount_tax_compensation_amount as string,\n\t\tshipping_discount_tax_compensation_amount as string,\n\t\tbase_shipping_discount_tax_compensation_amnt as string,\n\t\tdiscount_tax_compensation_invoiced as string,\n\t\tbase_discount_tax_compensation_invoiced as string,\n\t\tdiscount_tax_compensation_refunded as string,\n\t\tbase_discount_tax_compensation_refunded as string,\n\t\tshipping_incl_tax as string,\n\t\tbase_shipping_incl_tax as string,\n\t\tcoupon_rule_name as string,\n\t\tpaypal_ipn_customer_notified as string,\n\t\tgift_message_id as string,\n\t\tstatus_label as string,\n\t\t{item:item_id} as string,\n\t\t{item:order_id} as string,\n\t\t{item:parent_item_id} as string,\n\t\t{item:quote_item_id} as string,\n\t\t{item:store_id} as string,\n\t\t{item:created_at} as string,\n\t\t{item:updated_at} as string,\n\t\t{item:product_id} as string,\n\t\t{item:product_type} as string,\n\t\t{item:product_options} as string,\n\t\t{item:weight} as string,\n\t\t{item:is_virtual} as string,\n\t\t{item:sku} as string,\n\t\t{item:name} as string,\n\t\t{item:description} as string,\n\t\t{item:applied_rule_ids} as string,\n\t\t{item:additional_data} as string,\n\t\t{item:is_qty_decimal} as string,\n\t\t{item:no_discount} as string,\n\t\t{item:qty_backordered} as string,\n\t\t{item:qty_canceled} as string,\n\t\t{item:qty_invoiced} as string,\n\t\t{item:qty_ordered} as string,\n\t\t{item:qty_refunded} as string,\n\t\t{item:qty_shipped} as string,\n\t\t{item:base_cost} as string,\n\t\t{item:price} as string,\n\t\t{item:base_price} as string,\n\t\t{item:original_price} as string,\n\t\t{item:base_original_price} as string,\n\t\t{item:tax_percent} as string,\n\t\t{item:tax_amount} as string,\n\t\t{item:base_tax_amount} as string,\n\t\t{item:tax_invoiced} as string,\n\t\t{item:base_tax_invoiced} as string,\n\t\t{item:discount_percent} as string,\n\t\t{item:discount_amount} as string,\n\t\t{item:base_discount_amount} as string,\n\t\t{item:discount_invoiced} as string,\n\t\t{item:base_discount_invoiced} as string,\n\t\t{item:amount_refunded} as string,\n\t\t{item:base_amount_refunded} as string,\n\t\t{item:row_total} as string,\n\t\t{item:base_row_total} as string,\n\t\t{item:row_invoiced} as string,\n\t\t{item:base_row_invoiced} as string,\n\t\t{item:row_weight} as string,\n\t\t{item:base_tax_before_discount} as string,\n\t\t{item:tax_before_discount} as string,\n\t\t{item:ext_order_item_id} as string,\n\t\t{item:locked_do_invoice} as string,\n\t\t{item:locked_do_ship} as string,\n\t\t{item:price_incl_tax} as string,\n\t\t{item:base_price_incl_tax} as string,\n\t\t{item:row_total_incl_tax} as string,\n\t\t{item:base_row_total_incl_tax} as string,\n\t\t{item:discount_tax_compensation_amount} as string,\n\t\t{item:base_discount_tax_compensation_amount} as string,\n\t\t{item:discount_tax_compensation_invoiced} as string,\n\t\t{item:base_discount_tax_compensation_invoiced} as string,\n\t\t{item:discount_tax_compensation_refunded} as string,\n\t\t{item:base_discount_tax_compensation_refunded} as string,\n\t\t{item:tax_canceled} as string,\n\t\t{item:discount_tax_compensation_canceled} as string,\n\t\t{item:tax_refunded} as string,\n\t\t{item:base_tax_refunded} as string,\n\t\t{item:discount_refunded} as string,\n\t\t{item:base_discount_refunded} as string,\n\t\t{item:free_shipping} as string,\n\t\t{item:gift_message_id} as string,\n\t\t{item:gift_message_available} as string,\n\t\t{item:weee_tax_applied} as string,\n\t\t{item:weee_tax_applied_amount} as string,\n\t\t{item:weee_tax_applied_row_amount} as string,\n\t\t{item:weee_tax_disposition} as string,\n\t\t{item:weee_tax_row_disposition} as string,\n\t\t{item:base_weee_tax_applied_amount} as string,\n\t\t{item:base_weee_tax_applied_row_amnt} as string,\n\t\t{item:base_weee_tax_disposition} as string,\n\t\t{item:base_weee_tax_row_disposition} as string,\n\t\t{address:entity_id} as string,\n\t\t{address:parent_id} as string,\n\t\t{address:customer_address_id} as string,\n\t\t{address:quote_address_id} as string,\n\t\t{address:region_id} as string,\n\t\t{address:customer_id} as string,\n\t\t{address:fax} as string,\n\t\t{address:region} as string,\n\t\t{address:postcode} as string,\n\t\t{address:lastname} as string,\n\t\t{address:street} as string,\n\t\t{address:city} as string,\n\t\t{address:email} as string,\n\t\t{address:telephone} as string,\n\t\t{address:country_id} as string,\n\t\t{address:firstname} as string,\n\t\t{address:address_type} as string,\n\t\t{address:prefix} as string,\n\t\t{address:middlename} as string,\n\t\t{address:suffix} as string,\n\t\t{address:company} as string,\n\t\t{address:vat_id} as string,\n\t\t{address:vat_is_valid} as string,\n\t\t{address:vat_request_id} as string,\n\t\t{address:vat_request_date} as string,\n\t\t{address:vat_request_success} as string,\n\t\t{payment:entity_id} as string,\n\t\t{payment:parent_id} as string,\n\t\t{payment:base_shipping_captured} as string,\n\t\t{payment:shipping_captured} as string,\n\t\t{payment:amount_refunded} as string,\n\t\t{payment:base_amount_paid} as string,\n\t\t{payment:amount_canceled} as string,\n\t\t{payment:base_amount_authorized} as string,\n\t\t{payment:base_amount_paid_online} as string,\n\t\t{payment:base_amount_refunded_online} as string,\n\t\t{payment:base_shipping_amount} as string,\n\t\t{payment:shipping_amount} as string,\n\t\t{payment:amount_paid} as string,\n\t\t{payment:amount_authorized} as string,\n\t\t{payment:base_amount_ordered} as string,\n\t\t{payment:base_shipping_refunded} as string,\n\t\t{payment:shipping_refunded} as string,\n\t\t{payment:base_amount_refunded} as string,\n\t\t{payment:amount_ordered} as string,\n\t\t{payment:base_amount_canceled} as string,\n\t\t{payment:quote_payment_id} as string,\n\t\t{payment:additional_data} as string,\n\t\t{payment:cc_exp_month} as string,\n\t\t{payment:cc_ss_start_year} as string,\n\t\t{payment:echeck_bank_name} as string,\n\t\t{payment:method} as string,\n\t\t{payment:cc_debug_request_body} as string,\n\t\t{payment:cc_secure_verify} as string,\n\t\t{payment:protection_eligibility} as string,\n\t\t{payment:cc_approval} as string,\n\t\t{payment:cc_last_4} as string,\n\t\t{payment:cc_status_description} as string,\n\t\t{payment:echeck_type} as string,\n\t\t{payment:cc_debug_response_serialized} as string,\n\t\t{payment:cc_ss_start_month} as string,\n\t\t{payment:echeck_account_type} as string,\n\t\t{payment:last_trans_id} as string,\n\t\t{payment:cc_cid_status} as string,\n\t\t{payment:cc_owner} as string,\n\t\t{payment:cc_type} as string,\n\t\t{payment:po_number} as string,\n\t\t{payment:cc_exp_year} as string,\n\t\t{payment:cc_status} as string,\n\t\t{payment:echeck_routing_number} as string,\n\t\t{payment:account_status} as string,\n\t\t{payment:anet_trans_method} as string,\n\t\t{payment:cc_debug_response_body} as string,\n\t\t{payment:cc_ss_issue} as string,\n\t\t{payment:echeck_account_name} as string,\n\t\t{payment:cc_avs_status} as string,\n\t\t{payment:cc_number_enc} as string,\n\t\t{payment:cc_trans_id} as string,\n\t\t{payment:address_status} as string,\n\t\t{payment:additional_information} as string,\n\t\t{transaction:transaction_id} as string,\n\t\t{transaction:parent_id} as string,\n\t\t{transaction:order_id} as string,\n\t\t{transaction:payment_id} as string,\n\t\t{transaction:txn_id} as string,\n\t\t{transaction:parent_txn_id} as string,\n\t\t{transaction:txn_type} as string,\n\t\t{transaction:is_closed} as string,\n\t\t{transaction:additional_information} as string,\n\t\t{transaction:created_at} as string,\n\t\t{shipment:entity_id} as string,\n\t\t{shipment:store_id} as string,\n\t\t{shipment:total_weight} as string,\n\t\t{shipment:total_qty} as string,\n\t\t{shipment:email_sent} as string,\n\t\t{shipment:send_email} as string,\n\t\t{shipment:order_id} as string,\n\t\t{shipment:customer_id} as string,\n\t\t{shipment:shipping_address_id} as string,\n\t\t{shipment:billing_address_id} as string,\n\t\t{shipment:shipment_status} as string,\n\t\t{shipment:increment_id} as string,\n\t\t{shipment:created_at} as string,\n\t\t{shipment:updated_at} as string,\n\t\t{shipment:packages} as string,\n\t\t{shipment:shipping_label} as string,\n\t\t{shipment:customer_note} as string,\n\t\t{shipment:customer_note_notify} as string,\n\t\t{shipment_item:entity_id} as string,\n\t\t{shipment_item:parent_id} as string,\n\t\t{shipment_item:row_total} as string,\n\t\t{shipment_item:price} as string,\n\t\t{shipment_item:weight} as string,\n\t\t{shipment_item:qty} as string,\n\t\t{shipment_item:product_id} as string,\n\t\t{shipment_item:order_item_id} as string,\n\t\t{shipment_item:additional_data} as string,\n\t\t{shipment_item:description} as string,\n\t\t{shipment_item:name} as string,\n\t\t{shipment_item:sku} as string,\n\t\t{shipment_comment:entity_id} as string,\n\t\t{shipment_comment:parent_id} as string,\n\t\t{shipment_comment:is_customer_notified} as string,\n\t\t{shipment_comment:is_visible_on_front} as string,\n\t\t{shipment_comment:comment} as string,\n\t\t{shipment_comment:created_at} as string,\n\t\t{shipment_track:entity_id} as string,\n\t\t{shipment_track:parent_id} as string,\n\t\t{shipment_track:weight} as string,\n\t\t{shipment_track:qty} as string,\n\t\t{shipment_track:order_id} as string,\n\t\t{shipment_track:track_number} as string,\n\t\t{shipment_track:description} as string,\n\t\t{shipment_track:title} as string,\n\t\t{shipment_track:carrier_code} as string,\n\t\t{shipment_track:created_at} as string,\n\t\t{shipment_track:updated_at} as string,\n\t\t{invoice:entity_id} as string,\n\t\t{invoice:store_id} as string,\n\t\t{invoice:base_grand_total} as string,\n\t\t{invoice:shipping_tax_amount} as string,\n\t\t{invoice:tax_amount} as string,\n\t\t{invoice:base_tax_amount} as string,\n\t\t{invoice:store_to_order_rate} as string,\n\t\t{invoice:base_shipping_tax_amount} as string,\n\t\t{invoice:base_discount_amount} as string,\n\t\t{invoice:base_to_order_rate} as string,\n\t\t{invoice:grand_total} as string,\n\t\t{invoice:shipping_amount} as string,\n\t\t{invoice:subtotal_incl_tax} as string,\n\t\t{invoice:base_subtotal_incl_tax} as string,\n\t\t{invoice:store_to_base_rate} as string,\n\t\t{invoice:base_shipping_amount} as string,\n\t\t{invoice:total_qty} as string,\n\t\t{invoice:base_to_global_rate} as string,\n\t\t{invoice:subtotal} as string,\n\t\t{invoice:base_subtotal} as string,\n\t\t{invoice:discount_amount} as string,\n\t\t{invoice:billing_address_id} as string,\n\t\t{invoice:is_used_for_refund} as string,\n\t\t{invoice:order_id} as string,\n\t\t{invoice:email_sent} as string,\n\t\t{invoice:send_email} as string,\n\t\t{invoice:can_void_flag} as string,\n\t\t{invoice:state} as string,\n\t\t{invoice:shipping_address_id} as string,\n\t\t{invoice:store_currency_code} as string,\n\t\t{invoice:transaction_id} as string,\n\t\t{invoice:order_currency_code} as string,\n\t\t{invoice:base_currency_code} as string,\n\t\t{invoice:global_currency_code} as string,\n\t\t{invoice:increment_id} as string,\n\t\t{invoice:created_at} as string,\n\t\t{invoice:updated_at} as string,\n\t\t{invoice:discount_tax_compensation_amount} as string,\n\t\t{invoice:base_discount_tax_compensation_amount} as string,\n\t\t{invoice:shipping_discount_tax_compensation_amount} as string,\n\t\t{invoice:base_shipping_discount_tax_compensation_amnt} as string,\n\t\t{invoice:shipping_incl_tax} as string,\n\t\t{invoice:base_shipping_incl_tax} as string,\n\t\t{invoice:base_total_refunded} as string,\n\t\t{invoice:discount_description} as string,\n\t\t{invoice:customer_note} as string,\n\t\t{invoice:customer_note_notify} as string,\n\t\t{invoice_item:entity_id} as string,\n\t\t{invoice_item:parent_id} as string,\n\t\t{invoice_item:base_price} as string,\n\t\t{invoice_item:tax_amount} as string,\n\t\t{invoice_item:base_row_total} as string,\n\t\t{invoice_item:discount_amount} as string,\n\t\t{invoice_item:row_total} as string,\n\t\t{invoice_item:base_discount_amount} as string,\n\t\t{invoice_item:price_incl_tax} as string,\n\t\t{invoice_item:base_tax_amount} as string,\n\t\t{invoice_item:base_price_incl_tax} as string,\n\t\t{invoice_item:qty} as string,\n\t\t{invoice_item:base_cost} as string,\n\t\t{invoice_item:price} as string,\n\t\t{invoice_item:base_row_total_incl_tax} as string,\n\t\t{invoice_item:row_total_incl_tax} as string,\n\t\t{invoice_item:product_id} as string,\n\t\t{invoice_item:order_item_id} as string,\n\t\t{invoice_item:additional_data} as string,\n\t\t{invoice_item:description} as string,\n\t\t{invoice_item:sku} as string,\n\t\t{invoice_item:name} as string,\n\t\t{invoice_item:discount_tax_compensation_amount} as string,\n\t\t{invoice_item:base_discount_tax_compensation_amount} as string,\n\t\t{invoice_item:tax_ratio} as string,\n\t\t{invoice_item:weee_tax_applied} as string,\n\t\t{invoice_item:weee_tax_applied_amount} as string,\n\t\t{invoice_item:weee_tax_applied_row_amount} as string,\n\t\t{invoice_item:weee_tax_disposition} as string,\n\t\t{invoice_item:weee_tax_row_disposition} as string,\n\t\t{invoice_item:base_weee_tax_applied_amount} as string,\n\t\t{invoice_item:base_weee_tax_applied_row_amnt} as string,\n\t\t{invoice_item:base_weee_tax_disposition} as string,\n\t\t{invoice_item:base_weee_tax_row_disposition} as string,\n\t\t{invoice_comment:entity_id} as string,\n\t\t{invoice_comment:parent_id} as string,\n\t\t{invoice_comment:is_customer_notified} as string,\n\t\t{invoice_comment:is_visible_on_front} as string,\n\t\t{invoice_comment:comment} as string,\n\t\t{invoice_comment:created_at} as string,\n\t\t{creditmemo:entity_id} as string,\n\t\t{creditmemo:store_id} as string,\n\t\t{creditmemo:adjustment_positive} as string,\n\t\t{creditmemo:base_shipping_tax_amount} as string,\n\t\t{creditmemo:store_to_order_rate} as string,\n\t\t{creditmemo:base_discount_amount} as string,\n\t\t{creditmemo:base_to_order_rate} as string,\n\t\t{creditmemo:grand_total} as string,\n\t\t{creditmemo:base_adjustment_negative} as string,\n\t\t{creditmemo:base_subtotal_incl_tax} as string,\n\t\t{creditmemo:shipping_amount} as string,\n\t\t{creditmemo:subtotal_incl_tax} as string,\n\t\t{creditmemo:adjustment_negative} as string,\n\t\t{creditmemo:base_shipping_amount} as string,\n\t\t{creditmemo:store_to_base_rate} as string,\n\t\t{creditmemo:base_to_global_rate} as string,\n\t\t{creditmemo:base_adjustment} as string,\n\t\t{creditmemo:base_subtotal} as string,\n\t\t{creditmemo:discount_amount} as string,\n\t\t{creditmemo:subtotal} as string,\n\t\t{creditmemo:adjustment} as string,\n\t\t{creditmemo:base_grand_total} as string,\n\t\t{creditmemo:base_adjustment_positive} as string,\n\t\t{creditmemo:base_tax_amount} as string,\n\t\t{creditmemo:shipping_tax_amount} as string,\n\t\t{creditmemo:tax_amount} as string,\n\t\t{creditmemo:order_id} as string,\n\t\t{creditmemo:email_sent} as string,\n\t\t{creditmemo:send_email} as string,\n\t\t{creditmemo:creditmemo_status} as string,\n\t\t{creditmemo:state} as string,\n\t\t{creditmemo:shipping_address_id} as string,\n\t\t{creditmemo:billing_address_id} as string,\n\t\t{creditmemo:invoice_id} as string,\n\t\t{creditmemo:store_currency_code} as string,\n\t\t{creditmemo:order_currency_code} as string,\n\t\t{creditmemo:base_currency_code} as string,\n\t\t{creditmemo:global_currency_code} as string,\n\t\t{creditmemo:transaction_id} as string,\n\t\t{creditmemo:increment_id} as string,\n\t\t{creditmemo:created_at} as string,\n\t\t{creditmemo:updated_at} as string,\n\t\t{creditmemo:discount_tax_compensation_amount} as string,\n\t\t{creditmemo:base_discount_tax_compensation_amount} as string,\n\t\t{creditmemo:shipping_discount_tax_compensation_amount} as string,\n\t\t{creditmemo:base_shipping_discount_tax_compensation_amnt} as string,\n\t\t{creditmemo:shipping_incl_tax} as string,\n\t\t{creditmemo:base_shipping_incl_tax} as string,\n\t\t{creditmemo:discount_description} as string,\n\t\t{creditmemo:customer_note} as string,\n\t\t{creditmemo:customer_note_notify} as string,\n\t\t{creditmemo_item:entity_id} as string,\n\t\t{creditmemo_item:parent_id} as string,\n\t\t{creditmemo_item:base_price} as string,\n\t\t{creditmemo_item:tax_amount} as string,\n\t\t{creditmemo_item:base_row_total} as string,\n\t\t{creditmemo_item:discount_amount} as string,\n\t\t{creditmemo_item:row_total} as string,\n\t\t{creditmemo_item:base_discount_amount} as string,\n\t\t{creditmemo_item:price_incl_tax} as string,\n\t\t{creditmemo_item:base_tax_amount} as string,\n\t\t{creditmemo_item:base_price_incl_tax} as string,\n\t\t{creditmemo_item:qty} as string,\n\t\t{creditmemo_item:base_cost} as string,\n\t\t{creditmemo_item:price} as string,\n\t\t{creditmemo_item:base_row_total_incl_tax} as string,\n\t\t{creditmemo_item:row_total_incl_tax} as string,\n\t\t{creditmemo_item:product_id} as string,\n\t\t{creditmemo_item:order_item_id} as string,\n\t\t{creditmemo_item:additional_data} as string,\n\t\t{creditmemo_item:description} as string,\n\t\t{creditmemo_item:sku} as string,\n\t\t{creditmemo_item:name} as string,\n\t\t{creditmemo_item:discount_tax_compensation_amount} as string,\n\t\t{creditmemo_item:base_discount_tax_compensation_amount} as string,\n\t\t{creditmemo_item:tax_ratio} as string,\n\t\t{creditmemo_item:weee_tax_applied} as string,\n\t\t{creditmemo_item:weee_tax_applied_amount} as string,\n\t\t{creditmemo_item:weee_tax_applied_row_amount} as string,\n\t\t{creditmemo_item:weee_tax_disposition} as string,\n\t\t{creditmemo_item:weee_tax_row_disposition} as string,\n\t\t{creditmemo_item:base_weee_tax_applied_amount} as string,\n\t\t{creditmemo_item:base_weee_tax_applied_row_amnt} as string,\n\t\t{creditmemo_item:base_weee_tax_disposition} as string,\n\t\t{creditmemo_item:base_weee_tax_row_disposition} as string,\n\t\t{creditmemo_comment:entity_id} as string,\n\t\t{creditmemo_comment:parent_id} as string,\n\t\t{creditmemo_comment:is_customer_notified} as string,\n\t\t{creditmemo_comment:is_visible_on_front} as string,\n\t\t{creditmemo_comment:comment} as string,\n\t\t{creditmemo_comment:created_at} as string,\n\t\t{status_history:entity_id} as string,\n\t\t{status_history:parent_id} as string,\n\t\t{status_history:is_customer_notified} as string,\n\t\t{status_history:is_visible_on_front} as string,\n\t\t{status_history:comment} as string,\n\t\t{status_history:status} as string,\n\t\t{status_history:created_at} as string,\n\t\t{status_history:entity_name} as string,\n\t\t{tax:tax_id} as string,\n\t\t{tax:order_id} as string,\n\t\t{tax:code} as string,\n\t\t{tax:title} as string,\n\t\t{tax:percent} as string,\n\t\t{tax:amount} as string,\n\t\t{tax:priority} as string,\n\t\t{tax:position} as string,\n\t\t{tax:base_amount} as string,\n\t\t{tax:process} as string,\n\t\t{tax:base_real_amount} as string,\n\t\t{tax_item:tax_item_id} as string,\n\t\t{tax_item:tax_id} as string,\n\t\t{tax_item:item_id} as string,\n\t\t{tax_item:tax_percent} as string,\n\t\t{tax_item:amount} as string,\n\t\t{tax_item:base_amount} as string,\n\t\t{tax_item:real_amount} as string,\n\t\t{tax_item:real_base_amount} as string,\n\t\t{tax_item:associated_item_id} as string,\n\t\t{tax_item:taxable_item_type} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> SourceMagentoOrders\nSourceMagentoOrders filter(!isNull(status)) ~> Filter1\nFilter1 select(mapColumn(\n\t\tPaymentStatusId = {status_history:created_at},\n\t\tPaymentStatusName = {status_history:entity_name}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> GetPaymentStatusAttributes\nFilter1 select(mapColumn(\n\t\tPaymentId = {payment:parent_id},\n\t\tPaymentAmount = {payment:base_amount_paid},\n\t\tPaymentStatus = {status_history:entity_name},\n\t\tPaymentCardAcquisitionMethodId = {payment:quote_payment_id}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nGetDistinctPaymentStatus derive(PaymentStatusDescription = concat('Payment Description ',PaymentStatusName),\n\t\tEntityCode = 'Contoso') ~> GetPaymentDescription\nGetPaymentStatusAttributes aggregate(groupBy(PaymentStatusId,\n\t\tPaymentStatusName),\n\tNoOfPayment = count(PaymentStatusId)) ~> GetDistinctPaymentStatus\nSelect3 derive(EntityCode = 'Contoso') ~> GetEntityCodeForPayment\nGetPaymentDescription sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'RetailLakeDB',\n\ttableName: 'PaymentStatus',\n\trecreate:true,\n\tmapColumn(\n\t\tPaymentStatusId,\n\t\tPaymentStatusName,\n\t\tPaymentStatusDescription,\n\t\tEntityCode\n\t)) ~> PaymentStatus\nGetEntityCodeForPayment sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'RetailLakeDB',\n\ttableName: 'Payment',\n\trecreate:true,\n\tmapColumn(\n\t\tPaymentId,\n\t\tPaymentAmount,\n\t\tPaymentStatus,\n\t\tPaymentCardAcquisitionMethodId,\n\t\tEntityCode\n\t)) ~> Payment"
        }
    }
}