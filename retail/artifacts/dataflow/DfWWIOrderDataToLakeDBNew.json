{
    "name": "DfWWIOrderDataToLakeDBNew",
    "properties": {
        "folder": {
            "name": "Load WWI And Magento Data To LakeDB"
        },
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "WWISales",
                        "type": "DatasetReference"
                    },
                    "name": "WWISourceSalesData"
                },
                {
                    "dataset": {
                        "referenceName": "WWIData",
                        "type": "DatasetReference"
                    },
                    "name": "WWISourceProductData"
                }
            ],
            "sinks": [
                {
                    "name": "Order"
                }
            ],
            "transformations": [
                {
                    "name": "GetMissingAttributeData"
                },
                {
                    "name": "GetOrderAttributesData"
                }
            ],
            "script": "source(output(\n\t\tSalesId as string,\n\t\tCustomerId as string,\n\t\tProductId as string,\n\t\tQuantity as string,\n\t\tPrice as string,\n\t\tTotalAmount as string,\n\t\tTransactionDate as string,\n\t\tProfitAmount as string,\n\t\tHour as string,\n\t\tMinute as string,\n\t\tStoreId as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> WWISourceSalesData\nsource(output(\n\t\tProducts_ID as string,\n\t\tProductID as string,\n\t\tName as string,\n\t\tBrand as string,\n\t\tPrice as string,\n\t\tCategory as string,\n\t\tThumbnail_FileName as string,\n\t\tAdImage_FileName as string,\n\t\tSoundFile_FileName as string,\n\t\tSubCampaigns as string,\n\t\tTargetGender as string,\n\t\tTargetClassification as string,\n\t\tTargetGeneration as string,\n\t\tTags as string,\n\t\tBLECode as string,\n\t\tThumbnail as string,\n\t\tAdImage as string,\n\t\tSoundFile as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> WWISourceProductData\nGetOrderAttributesData derive(EntityCode = 'WideWorldImporters',\n\t\tProductAdjustmentAmount = 0,\n\t\tProductAdjustmentPercentage = .0,\n\t\tItemSku = 'Null',\n\t\tOrderStatus = 'Null',\n\t\tOrderTotalTaxAmount = 0,\n\t\tTotalShippingChargeAmount = .0) ~> GetMissingAttributeData\nWWISourceSalesData select(mapColumn(\n\t\tSalesId,\n\t\tCustomerId,\n\t\tProductId,\n\t\tQuantity,\n\t\tPrice,\n\t\tTotalAmount,\n\t\tTransactionDate,\n\t\tProfitAmount,\n\t\tHour,\n\t\tMinute,\n\t\tStoreId\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> GetOrderAttributesData\nGetMissingAttributeData sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'WWIRetailLakeDB',\n\ttableName: 'Order',\n\tmapColumn(\n\t\tOrderId = SalesId,\n\t\tCustomerId,\n\t\tQuantity,\n\t\tQuantityBooked = Quantity,\n\t\tQuantityBilled = Quantity,\n\t\tProductListPriceAmount = Price,\n\t\tProductSalesPriceAmount = TotalAmount,\n\t\tEntityCode,\n\t\tProductAdjustmentAmount,\n\t\tProductAdjustmentPercentage,\n\t\tItemSku,\n\t\tOrderStatus,\n\t\tOrderTotalTaxAmount,\n\t\tTotalShippingChargeAmount\n\t)) ~> Order"
        }
    }
}