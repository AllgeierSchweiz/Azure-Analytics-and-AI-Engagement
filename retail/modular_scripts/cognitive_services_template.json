{
   "$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
   "contentVersion":"1.0.0.0",
   "parameters":{
      "accounts_retailspeechapp_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "accounts_transqna_retail_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "forms_retail_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "accounts_cogretail_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "accounts_qnamaker_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "search_retail_qna_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
      "search_srch_retail_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "app_retail_qna_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "serverfarms_app_retail_qna_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "accounts_RetailMedia_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "mediaservices_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "resource_group_name": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       },
       "location": {
         "type": "String",
         "metadata": {
           "description": ""
         }
       }
   },
   "variables":{},
   "resources":[
      {
         "type":"Microsoft.CognitiveServices/accounts",
         "apiVersion":"2021-10-01",
         "name":"[parameters('accounts_retailspeechapp_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "name":"S0"
         },
         "kind":"SpeechServices",
         "identity":{
            "type":"None",
            "userAssignedIdentities":{
               
            }
         },
         "properties":{
            "networkAcls":{
               "defaultAction":"Allow",
               "virtualNetworkRules":[
                  
               ],
               "ipRules":[
                  
               ]
            },
            "publicNetworkAccess":"Enabled"
         }
      },
      {
         "type":"Microsoft.CognitiveServices/accounts",
         "apiVersion":"2021-04-30",
         "name":"[parameters('accounts_transqna_retail_name')]",
         "location":"global",
         "sku":{
            "name":"S1"
         },
         "kind":"TextTranslation",
         "properties":{
            "customSubDomainName":"[parameters('accounts_transqna_retail_name')]",
            "publicNetworkAccess":"Enabled"
         }
      },
      {
         "type":"Microsoft.CognitiveServices/accounts",
         "apiVersion":"2021-10-01",
         "name":"[parameters('forms_retail_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "name":"S0"
         },
         "kind":"FormRecognizer",
         "properties":{
            "privateEndpointConnections":[
               
            ],
            "publicNetworkAccess":"Enabled"
         }
      },
      {
         "type":"Microsoft.CognitiveServices/accounts",
         "apiVersion":"2021-10-01",
         "name":"[parameters('accounts_cogretail_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "name":"S0"
         },
         "kind":"CognitiveServices",
         "identity":{
            "type":"None",
            "userAssignedIdentities":{
               
            }
         },
         "properties":{
            "apiProperties":{
               
            },
            "customSubDomainName":"[parameters('accounts_cogretail_name')]",
            "publicNetworkAccess":"Enabled"
         }
      },
      {
         "type":"Microsoft.VideoIndexer/accounts",
         "apiVersion":"2021-11-10-preview",
         "name":"[parameters('accounts_RetailMedia_name')]",
         "location":"[parameters('location')]",
         "dependsOn":[
            "[resourceId('Microsoft.Media/mediaservices', parameters('mediaservices_name'))]"
         ],
         "identity":{
            "type":"SystemAssigned"
         },
         "properties":{
            "mediaServices":{
               "resourceId":"[resourceId('Microsoft.Media/mediaservices', parameters('mediaservices_name'))]"
            }
         }
      },
      {
         "type":"Microsoft.CognitiveServices/accounts",
         "apiVersion":"2021-04-30",
         "name":"[parameters('accounts_qnamaker_name')]",
         "location":"westus",
         "dependsOn":[
            "[resourceId('Microsoft.Web/Sites', parameters('app_retail_qna_name'))]",
            "[resourceId('Microsoft.Search/searchServices', parameters('search_retail_qna_name'))]"
         ],
         "sku":{
            "name":"S0"
         },
         "kind":"QnAMaker",
         "properties":{
            "apiProperties":{
               "qnaRuntimeEndpoint":"[concat('https://',reference(resourceId('Microsoft.Web/sites', parameters('app_retail_qna_name'))).hostNames[0])]"
            },
            "customSubDomainName":"[parameters('accounts_qnamaker_name')]"
         }
      },
      {
         "type":"Microsoft.Search/searchServices",
         "apiVersion":"2015-08-19",
         "name":"[parameters('search_retail_qna_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "name":"basic"
         },
         "properties":{
            "replicaCount":1,
            "partitionCount":1,
            "hostingMode":"Default"
         }
      },
      {
         "type":"Microsoft.Search/searchServices",
         "apiVersion":"2021-04-01-preview",
         "name":"[parameters('search_srch_retail_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "name":"standard"
         },
         "properties":{
            "replicaCount":1,
            "partitionCount":1,
            "hostingMode":"Default",
            "publicNetworkAccess":"Enabled",
            "networkRuleSet":{
               "ipRules":[
                  
               ],
               "bypass":"None"
            },
            "encryptionWithCmk":{
               "enforcement":"Unspecified"
            },
            "disableLocalAuth":false,
            "authOptions":{
               "apiKeyOnly":{
                  
               }
            },
            "disabledDataExfiltrationOptions":[
               
            ],
            "semanticSearch":"free"
         }
      },
      {
         "type":"Microsoft.Web/sites",
         "apiVersion":"2016-08-01",
         "name":"[parameters('app_retail_qna_name')]",
         "location":"[parameters('location')]",
         "dependsOn":[
            "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_app_retail_qna_name'))]"
         ],
         "properties":{
            "enabled":true,
            "siteConfig":{
               "cors":{
                  "allowedOrigins":[
                     "*"
                  ]
               }
            },
            "name":"[parameters('app_retail_qna_name')]",
            "serverFarmId":"[resourceId(parameters('resource_group_name'),'Microsoft.Web/serverfarms', parameters('serverfarms_app_retail_qna_name'))]",
            "hostingEnvironment":""
         },
         "resources":[
            {
               "type":"config",
               "apiVersion":"2015-08-01",
               "name":"appsettings",
               "dependsOn":[
                  "[resourceId('Microsoft.Web/Sites', parameters('app_retail_qna_name'))]",
                  "[resourceId('Microsoft.Search/searchServices/', parameters('search_retail_qna_name'))]"
               ],
               "properties":{
                  "AzureSearchName":"[parameters('search_retail_qna_name')]",
                  "AzureSearchAdminKey":"[listAdminKeys(resourceId('Microsoft.Search/searchServices/', parameters('search_retail_qna_name')), '2015-08-19').primaryKey]",
                  "PrimaryEndpointKey":"[concat(parameters('app_retail_qna_name'), '-PrimaryEndpointKey')]",
                  "SecondaryEndpointKey":"[concat(parameters('app_retail_qna_name'), '-SecondaryEndpointKey')]",
                  "DefaultAnswer":"No good match found in KB.",
                  "QNAMAKER_EXTENSION_VERSION":"latest"
               }
            }
         ]
      },
      {
         "type":"Microsoft.Web/serverfarms",
         "apiVersion":"2016-09-01",
         "name":"[parameters('serverfarms_app_retail_qna_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "Tier":"Standard",
            "Name":"S1"
         },
         "properties":{
            "name":"[parameters('serverfarms_app_retail_qna_name')]",
            "workerSizeId":"0",
            "reserved":false,
            "numberOfWorkers":"1",
            "hostingEnvironment":""
         }
      },
      {
         "type":"Microsoft.Web/sites",
         "apiVersion":"2016-08-01",
         "name":"[parameters('app_retail_qna_name')]",
         "location":"[parameters('location')]",
         "dependsOn":[
            "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_app_retail_qna_name'))]"
         ],
         "properties":{
            "enabled":true,
            "siteConfig":{
               "cors":{
                  "allowedOrigins":[
                     "*"
                  ]
               }
            },
            "name":"[parameters('app_retail_qna_name')]",
            "serverFarmId":"[resourceId(parameters('resource_group_name'),'Microsoft.Web/serverfarms', parameters('serverfarms_app_retail_qna_name'))]",
            "hostingEnvironment":""
         },
         "resources":[
            {
               "type":"config",
               "apiVersion":"2015-08-01",
               "name":"appsettings",
               "dependsOn":[
                  "[resourceId('Microsoft.Web/Sites', parameters('app_retail_qna_name'))]",
                  "[resourceId('Microsoft.Search/searchServices/', parameters('search_retail_qna_name'))]"
               ],
               "properties":{
                  "AzureSearchName":"[parameters('search_retail_qna_name')]",
                  "AzureSearchAdminKey":"[listAdminKeys(resourceId('Microsoft.Search/searchServices/', parameters('search_retail_qna_name')), '2015-08-19').primaryKey]",
                  "PrimaryEndpointKey":"[concat(parameters('app_retail_qna_name'), '-PrimaryEndpointKey')]",
                  "SecondaryEndpointKey":"[concat(parameters('app_retail_qna_name'), '-SecondaryEndpointKey')]",
                  "DefaultAnswer":"No good match found in KB.",
                  "QNAMAKER_EXTENSION_VERSION":"latest"
               }
            }
         ]
      },
      {
         "type":"Microsoft.Web/serverfarms",
         "apiVersion":"2016-09-01",
         "name":"[parameters('serverfarms_app_retail_qna_name')]",
         "location":"[parameters('location')]",
         "sku":{
            "Tier":"Standard",
            "Name":"S1"
         },
         "properties":{
            "name":"[parameters('serverfarms_app_retail_qna_name')]",
            "workerSizeId":"0",
            "reserved":false,
            "numberOfWorkers":"1",
            "hostingEnvironment":""
         }
      }
   ],
   "outputs":{
      
   }
}
